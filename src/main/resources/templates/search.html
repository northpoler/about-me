<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>搜索</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" th:href="@{../static/layui/css/layui.css}"/>
    <script type="text/javascript" src="http://hovertree.com/ziyuan/jquery/jquery-1.11.3.min.js"></script>
</head>
<body style="background-color: lightgoldenrodyellow">

<div class="layui-row" style="text-align: center;font-size: larger">
    <form action="http://www.baidu.com/baidu" target="_blank" onsubmit="return check()">
    <div class="layui-row">
        <div class="layui-col-md3">&nbsp;</div>
        <div class="layui-col-md6">
            <!--搜索框-->
            <div class="layui-form-item" style="margin-top: 10%">
                <img alt="logo" th:src="@{../static/image/logo.png}" style="width: 200px;cursor: pointer" onclick="toIndex()"/>
                <div class="layui-input-block" href="/index" style="margin-left: 10px;margin-right: 10px;margin-top: 50px">
                    <input type="text" name="word" style="font-size: medium;height: 44px" id="searchBody" placeholder="百度能搜到的这里都能搜..." autocomplete="off" class="layui-input">
                    <button style="position: absolute;top: 0;right: 6px;cursor: pointer" type="submit" class="layui-btn layui-btn-lg layui-btn-normal">
                        <i class="layui-icon layui-icon-search"></i>
                    </button>
                </div>
            </div>
            <!--常用链接-->
            <ul th:each="link : ${links}" class="layui-inline">
                <a th:href="@{${link.link}}" target="_blank" class="layui-btn" style="margin: 0 5px" th:title="${link.title}">
                    <i th:class="${link.icon}"></i>
                </a>
            </ul>
            <!--倒计时-->
            <div style="margin-top: 20px">
                <span id="countDownTitle" style="color: #333333">
                    <i class="layui-icon layui-icon-notice"></i>倒计时标题
                </span>
                <span id="countDown" style="color: #333333">
                    <i class="layui-icon layui-icon-log"></i>倒计时
                </span>
            </div>
        </div>
        <div class="layui-col-md3">&nbsp;</div>
    </div>
    </form>
</div>
<div style="position: fixed;bottom: 6%;width: 100%;font-size: larger;text-align: center;color: gray;">
    <a th:href="@{/}"><i>www.jianbing.pro</i></a>
</div>

</body>
<script th:src="@{../static/layui/layui.js}"></script>
<script type="text/javascript">

    function toIndex() {
        window.open("/");
    }
    function check(){
        var keyword = $("#searchBody").val();
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: '/keyword/insert',
            data: {"keyword": keyword},
            cache: false,
            async: true,
            success: function () {
                $("#searchBody").val();
            }
        });
        return true;
    }

    /*var form = layui.form;

    //监听提交
    form.on('submit(formDemo)', function (data) {
        layer.msg(JSON.stringify(data.field));
        return false;
    });*/

    $("#searchBody").focus();

    window.onload = function (ev) {
        getCountdown();
    };

    function getCountdown() {
        $.ajax({
            type: 'GET',
            dataType: 'json',
            url: '/countdown/get',
            data: {},
            cache: false,
            async: true,
            success: function (data) {
                titleA = data[0].title;
                endTimeA = data[0].endTime;
                daysA = data[0].days;
                titleB = data[1].title;
                endTimeB = data[1].endTime;
                if (endTimeA.length<6){
                    endTimeA[5] = 0;
                }
                if (endTimeB.length<6){
                    endTimeB[5] = 0;
                }
                daysB = data[1].days;
                endA = new Date(endTimeA[0],endTimeA[1]-1,endTimeA[2],endTimeA[3],endTimeA[4],endTimeA[5]);
                endB = new Date(endTimeB[0],endTimeB[1]-1,endTimeB[2],endTimeB[3],endTimeB[4],endTimeB[5]);
                countdown();
            }
        });
    }

    function countdown() {
        var now = new Date();
        var title = titleA;
        if (now > endA){
            endA = endB;
            title = titleB;
        }
        var today = now;
        var stopTime = endA;
        var shenyu = stopTime.getTime() - today.getTime(),//倒计时毫秒数
            shengyuD = parseInt(shenyu / (60 * 60 * 24 * 1000)),//转换为天
            D = parseInt(shenyu) - parseInt(shengyuD * 60 * 60 * 24 * 1000),//除去天的毫秒数
            shengyuH = parseInt(D / (60 * 60 * 1000)),//除去天的毫秒数转换成小时
            H = D - shengyuH * 60 * 60 * 1000,//除去天、小时的毫秒数
            shengyuM = parseInt(H / (60 * 1000));//除去天的毫秒数转换成分钟
        var S = parseInt((shenyu - shengyuD * 60 * 60 * 24 * 1000 - shengyuH * 60 * 60 * 1000 - shengyuM * 60 * 1000) / 1000)//除去天、小时、分的毫秒数转化为秒
        var MS = parseInt(shenyu - shengyuD * 60 * 60 * 24 * 1000 - shengyuH * 60 * 60 * 1000 - shengyuM * 60 * 1000 - S * 1000)//除去天、小时、分的毫秒数转化为秒
        MS = (Array(3).join('0') + MS).slice(-3);
        document.getElementById("countDown").innerHTML = (shengyuD + "天" + shengyuH + "小时" + shengyuM + "分" + S + "秒" + MS + "毫秒" + "<br>");
        $("#countDownTitle").html("<i style='font-size: large;color: deeppink' class=\"layui-icon layui-icon-notice\"></i>&nbsp;&nbsp;现在距离"+title+"还有：");
        setTimeout(countdown, 33);
    }



</script>
</html>